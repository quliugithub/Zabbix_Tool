<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Zabbix Agent æ§åˆ¶å°</title>
  <!-- å¼•å…¥åˆ†ç¦»çš„ CSS æ–‡ä»¶ -->
  <link rel="stylesheet" href="static/css/style.css">
  <style>
    /* === é’ˆå¯¹æ–°éœ€æ±‚çš„å†…è”æ ·å¼è¦†ç›– (å»ºè®®åç»­ç§»å…¥ style.css) === */

    /* åº•éƒ¨æ“ä½œåŒºåŸŸå®¹å™¨ - ç±»ä¼¼ Card Footer */
    .bottom-action-area {
      margin-top: 24px;
      padding-top: 20px;
      border-top: 1px solid var(--border);
    }

    /* åŒºåŸŸæ ‡é¢˜ */
    .action-section-title {
      font-size: 12px;
      font-weight: 700;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    /* æ¨¡å¼é€‰æ‹©ç½‘æ ¼ - 3åˆ—ç­‰å®½ */
    .mode-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
      margin-bottom: 24px;
    }

    /* å•ä¸ªæ¨¡å¼å¡ç‰‡ */
    .mode-card {
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      /* å·¦å¯¹é½æ›´æ˜“è¯» */
      justify-content: center;
      padding: 16px;
      background: #fff;
      border: 1px solid var(--border);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      height: 100%;
      /* ç¡®ä¿é«˜åº¦ä¸€è‡´ */
      box-sizing: border-box;
    }

    .mode-card:hover {
      border-color: var(--primary);
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.1);
      transform: translateY(-2px);
    }

    /* é€‰ä¸­çŠ¶æ€ */
    .mode-card:has(input:checked) {
      border-color: var(--primary);
      background: #eff6ff;
      /* var(--primary-light) very light */
      box-shadow: 0 0 0 1px var(--primary);
    }

    /* éšè—åŸç”Ÿ Radio */
    .mode-card input[type="radio"] {
      position: absolute;
      opacity: 0;
      width: 0;
      height: 0;
    }

    /* é€‰ä¸­æ—¶çš„å¯¹å‹¾å›¾æ ‡ */
    .mode-card:has(input:checked)::after {
      content: 'âœ”';
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 14px;
      color: var(--primary);
      font-weight: bold;
    }

    /* å¡ç‰‡ä¸»æ ‡é¢˜ */
    .mode-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 6px;
      display: block;
    }

    .mode-card:has(input:checked) .mode-title {
      color: var(--primary);
    }

    /* å¡ç‰‡å‰¯æ ‡é¢˜/æè¿° */
    .mode-desc {
      font-size: 12px;
      color: var(--text-secondary);
      line-height: 1.4;
    }

    .mode-card:has(input:checked) .mode-desc {
      color: #60a5fa;
      /* Lighter blue */
    }

    /* åº•éƒ¨å·¥å…·æ ï¼šå³ä¾§æŒ‰é’® */
    .action-toolbar {
      display: flex;
      align-items: center;
      justify-content: flex-end;
      /* é å³å¯¹é½ */
      gap: 16px;
      flex-wrap: wrap;
    }

    /* æŒ‰é’®ç»„ */
    .btn-group {
      display: flex;
      gap: 12px;
      align-items: center;
    }
  </style>
</head>

<body>

  <!-- Toast å®¹å™¨ -->
  <div class="toast-container" id="toastContainer"></div>

  <!-- å…¨å±€åˆå§‹åŒ– Loading -->
  <div id="global-loading">
    <div class="spinner"></div>
  </div>

  <div class="container">
    <header class="main-header">
      <h1>Zabbix Agent æ§åˆ¶å°</h1>
      <span class="status-badge">System Ready</span>
    </header>

    <div class="tabs">
      <div class="tab-btn active" data-tab="dashboard">ä»ªè¡¨ç›˜</div>
      <div class="tab-btn" data-tab="install">å®‰è£… Agent</div>
      <div class="tab-btn" data-tab="batch">æ‰¹é‡å®‰è£…</div>
      <div class="tab-btn" data-tab="tmpl">æ¨¡æ¿ç®¡ç†</div>
      <div class="tab-btn" data-tab="group">ç¾¤ç»„ç®¡ç†</div>
      <div class="tab-btn" data-tab="bind">æ¨¡æ¿ç»‘å®š</div>
      <div class="tab-btn" data-tab="uninstall">å¸è½½/åˆ é™¤</div>
      <div class="tab-btn" data-tab="config" style="margin-left: auto;">âš™ï¸ è®¾ç½®</div>
    </div>

    <!-- 1. ä»ªè¡¨ç›˜ -->
        <div id="tabContainer"></div>
  </div>

<!-- æ–°ç‰ˆæ—¥å¿—å¼¹çª— (Large) -->
  <div class="modal-backdrop" id="logModal">
    <div class="modal large">
      <header>
        <div style="display:flex; align-items:center; gap:10px;">
          <span style="font-size:18px;">ğŸ“œ æ‰§è¡Œæ—¥å¿—</span>
          <span class="status-badge" id="logCountBadge" style="display:none; font-weight:normal;">0</span>
        </div>
        <div style="display:flex; gap:8px; align-items:center;">
          <button class="secondary" onclick="refreshLogList()">ğŸ”„ åˆ·æ–°åˆ—è¡¨</button>
          <button class="secondary" onclick="closeModal('logModal')">âŒ å…³é—­</button>
        </div>
      </header>
      <div class="log-panel">
        <div class="log-list" id="logList">
          <!-- JS å¡«å…… -->
        </div>
        <div class="log-detail-wrapper">
          <pre id="logContent">è¯·ç‚¹å‡»å·¦ä¾§ä»»åŠ¡æŸ¥çœ‹è¯¦ç»†æ—¥å¿—...</pre>
        </div>
      </div>
    </div>
  </div>

  <!-- ç»“æœè¯¦æƒ…å¼¹çª— -->
  <div class="modal-backdrop" id="resultModal">
    <div class="modal">
      <header><span>è¯¦ç»†ä¿¡æ¯</span><button class="secondary" onclick="closeModal('resultModal')">å…³é—­</button>
      </header>
      <pre id="resultContent"></pre>
    </div>
  </div>

  <!-- æ¨¡æ¿/ç¾¤ç»„é€‰å–å¼¹çª— -->
  <div class="modal-backdrop" id="selectorModal">
    <div class="modal" style="max-width: 720px; display: flex; flex-direction: column; gap: 12px;">
      <header>
        <span id="selectorTitle">é€‰æ‹©</span>
        <div style="display:flex; gap:8px;">
          <button class="secondary" onclick="closeSelector()">å–æ¶ˆ</button>
          <button onclick="confirmSelector()">ç¡®å®š</button>
        </div>
      </header>
      <div style="display:flex; gap:8px; align-items:center;">
        <input id="selectorSearch" placeholder="è¾“å…¥åç§°æˆ–IDæœç´¢" style="flex:1;" oninput="filterSelectorList()" />
        <button class="secondary" onclick="renderSelectorOptions()">åˆ·æ–°</button>
        <button class="secondary danger-text" onclick="clearSelectorChoices()">æ¸…ç©ºé€‰æ‹©</button>
      </div>
      <div class="selector-list" id="selectorList" style="min-height:260px;"></div>
    </div>
  </div>

  <!-- ä¿å­˜æ‰¹æ¬¡å¼¹çª— -->
  <div class="modal-backdrop" id="saveBatchModal">
    <div class="modal" style="max-width:420px;">
      <header>
        <span id="saveBatchTitle">ä¿å­˜æ‰¹æ¬¡</span>
        <button class="secondary" onclick="closeModal('saveBatchModal')">å…³é—­</button>
      </header>
      <div style="display:flex; flex-direction:column; gap:12px;">
        <label style="font-weight:600; color:#0f172a;">æ‰¹æ¬¡åç§°</label>
        <input id="batchNameInput" class="batch-name-input" placeholder="è¯·è¾“å…¥æ‰¹æ¬¡åç§°" />
        <button onclick="saveCurrentBatch(this)" class="primary-action" style="width:100%;">ä¿å­˜</button>
      </div>
    </div>
  </div>

  <!-- æœªä¿å­˜æç¤ºå¼¹çª— -->
  <div class="modal-backdrop" id="unsavedModal">
    <div class="modal" style="max-width:460px;">
      <header>
        <span>æ£€æµ‹åˆ°æœªä¿å­˜çš„ä¿®æ”¹</span>
        <button class="secondary" onclick="closeUnsavedModal(false)">å…³é—­</button>
      </header>
      <div style="display:flex; flex-direction:column; gap:12px;">
        <p style="margin:0; color:#475569; line-height:1.6;">
          å½“å‰æ‰¹æ¬¡æœ‰æœªä¿å­˜çš„å˜æ›´ï¼Œæ˜¯å¦å…ˆä¿å­˜åå†æ‰§è¡Œï¼Ÿ
        </p>
        <div style="display:flex; gap:10px; justify-content:flex-end;">
          <button class="secondary" onclick="closeUnsavedModal(false)">ç¨åå†è¯´</button>
          <button onclick="confirmUnsavedAndSave()">ä¿å­˜å¹¶ç»§ç»­</button>
        </div>
      </div>
    </div>
  </div>

  <!-- å¼•å…¥åˆ†ç¦»çš„ JS æ–‡ä»¶ -->
  <script src="static/js/app.js"></script>
</body>

</html>
