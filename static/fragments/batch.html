<div id="batch" class="tab">
  <fieldset>
    <legend>批量安装（Excel 或手动编辑）</legend>

    <div class="batch-layout">
      <aside class="batch-history-panel">
        <div class="history-header">
          <div>
            <div class="history-title">历史批次</div>
            <div class="history-sub">点击批次加载到右侧</div>
          </div>
          <button class="secondary" id="toggleHistoryBtn" onclick="toggleHistoryPanel()" style="white-space:nowrap;">隐藏历史</button>
        </div>
        <div id="batchHistoryList" class="history-list"></div>
      </aside>

        <div class="batch-main-panel">
          <div class="batch-action-bar">
          <input type="file" id="batchFile" accept=".xlsx,.xls,.csv" onchange="handleFileSelect(this)" style="display:none;" />
          <button class="primary-action" id="importBtn" onclick="triggerBatchImport(this)">数据导入</button>
          <button class="secondary" onclick="downloadBatchTemplate()">下载模板</button>
          <button class="secondary" onclick="refreshBatchList()">刷新批次</button>
          <button class="secondary" id="addDataBtn" onclick="addRowsFromSelection()">添加数据</button>
          <button class="secondary danger-text" onclick="clearAllBatchRows()">清空全部</button>
          <button class="secondary danger-text" id="deleteRowsBtn" onclick="deleteSelectedRows()">删除数据</button>
          <button class="primary-action" onclick="runBatch('install', this)">批量安装</button>
          <button class="secondary" onclick="runBatch('uninstall', this)">批量卸载</button>
            <span class="batch-meta-inline">
              <span id="batchInfo">当前未选择批次</span>
              <span class="file-status-pill" id="fileStatusBar"><span id="fileNameDisplay"></span></span>
            </span>
          </div>

        <div class="editable-table-container">
          <table id="batchTable" class="editable-table">
            <thead>
              <tr>
                <th style="width:46px;">选</th>
                <th>主机名</th>
                <th>IP</th>
                <th>SSH用户</th>
                <th>SSH密码</th>
                <th>SSH端口</th>
                <th>Agent端口</th>
                <th>JMX端口</th>
                <th>Proxy</th>
                <th>模板IDs</th>
                <th>群组IDs</th>
                <th>状态</th>
                <th>日志</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>
  </fieldset>
  <button class="floating-history-btn" id="historyFloatBtn" onclick="toggleHistoryPanel()" title="显示历史批次">🗂 历史批次</button>
</div>
<!-- 4. 模板列表 -->
